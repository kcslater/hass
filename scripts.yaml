# GENERAL
good_morning:
  alias: "Good Morning"
  sequence:
    - service: light.turn_on
      data:
        entity_id: light.bedroom
        brightness_pct: 100
    - service: input_boolean.turn_off
      entity_id: input_boolean.sleeping

lock_if_closed:
  alias: "Lock The Door"
  sequence:
    - condition: state
      entity_id: binary_sensor.front_door
      state: 'off'
    - service: lock.lock
      entity_id: lock.home_door_lock

everything_off:
  alias: "Everything Off"
  sequence:
    - service: homeassistant.turn_off
      entity_id: group.bedroom
    - service: homeassistant.turn_off
      entity_id: group.upstairs
    - service: cover.close_cover
      entity_id: cover.garage_door_2
    - condition: state
      entity_id: input_boolean.guests_visiting
      state: 'off'
    - service: homeassistant.turn_off
      entity_id: group.downstairs

goodnight:
  alias: "Goodnight"
  sequence:
    - service: input_boolean.turn_on
      entity_id: input_boolean.sleeping
    - service: script.lock_if_closed
    - service: script.everything_off
    - service: alarm_control_panel.alarm_arm_home
      entity_id: alarm_control_panel.abode_alarm

time_for_bed:
  alias: "Time For Bed"
  sequence:
    - service: input_boolean.turn_on
      entity_id: input_boolean.sleeping
    - service: light.turn_on
      entity_id: light.bedroom
    - service: alarm_control_panel.alarm_arm_home
      entity_id: alarm_control_panel.abode_alarm
    - service: script.lock_if_closed
    - service: homeassistant.turn_off
      entity_id: group.upstairs
    - service: cover.close_cover
      entity_id: cover.garage_door_2
    - condition: state
      entity_id: input_boolean.guests_visiting
      state: 'off'
    - service: homeassistant.turn_off
      entity_id: group.downstairs

tv_time:
  alias: "TV Time"
  sequence:
    - service: homeassistant.turn_off
      entity_id: group.upstairs
    - service: cover.close_cover
      entity_id: cover.garage_door_2
    - service: homeassistant.turn_off
      entity_id: group.bedroom
    - service: homeassistant.turn_off
      entity_id: light.basement
    - service: media_player.turn_on
      entity_id: media_player.guest_room_stereo_main
    - service: media_player.select_source
      data:
        entity_id: media_player.guest_room_stereo_main
        source: 'tv'

goodbye:
  alias: "Goodbye"
  sequence:
    - service: alarm_control_panel.alarm_arm_away
      entity_id: alarm_control_panel.abode_alarm
    - service: input_boolean.turn_off
      entity_id: input_boolean.sleeping
    - service: script.lock_if_closed
    - service: script.everything_off
    # in case of guests
    - service: homeassistant.turn_off
      entity_id: group.downstairs

standby:
  alias: "Standby"
  sequence:
    - service: alarm_control_panel.alarm_disarm
      entity_id: alarm_control_panel.abode_alarm

# SPECIAL MUSIC
turntable:
  alias: "Turntable"
  sequence:
    - service: media_player.turn_on
      data:
        entity_id: media_player.living_room_stereo_main
    - delay: '00:00:02'
    - service: media_player.select_source
      data:
        entity_id: media_player.living_room_stereo_main
        source: phono
    - service: media_player.volume_set
      data:
        entity_id: media_player.living_room_stereo_main
        volume_level: 0.6
streaming:
  alias: "Streaming"
  sequence:
    - service: media_player.turn_on
      data:
        entity_id: media_player.living_room_stereo_main
    - delay: '00:00:02'
    - service: media_player.select_source
      data:
        entity_id: media_player.living_room_stereo_main
        source: spotify
    - service: media_player.volume_set
      data:
        entity_id: media_player.living_room_stereo_main
        volume_level: 0.55
close_garage:
  alias: "Close Garage"
  sequence:
    - service: cover.close_cover
      entity_id: cover.garage_door_2
spotify_play:
  alias: "Spotify Play"
  sequence:
    - service: media_player.media_play
      data:
        entity_id: media_player.spotify
spotify_pause:
  alias: "Spotify Pause"
  sequence:
    - service: media_player.media_pause
      data:
        entity_id: media_player.spotify
spotify_next:
  alias: "Spotify Next"
  sequence:
    - service: media_player.media_next_track
      data:
        entity_id: media_player.spotify
spotify_previous:
  alias: "Spotify Previous"
  sequence:
    - service: media_player.media_previous_track
      data:
        entity_id: media_player.spotify
spotify_up:
  alias: "Spotify Volume Up"
  sequence:
    - service: media_player.volume_up
      data_template:
        entity_id: >
          media_player.{{ states("sensor.spotify_source").replace(" ", "_").lower() }}_main
spotify_down:
  alias: "Spotify Volume Down"
  sequence:
    - service: media_player.volume_down
      data_template:
        entity_id: >
          media_player.{{ states("sensor.spotify_source").replace(" ", "_").lower() }}_main
spotify_up2:
  alias: "Spotify Volume Way Up"
  sequence:
    - service: media_player.volume_up
      data_template:
        entity_id: >
          media_player.{{ states("sensor.spotify_source").replace(" ", "_").lower() }}_main
    - service: media_player.volume_up
      data_template:
        entity_id: >
          media_player.{{ states("sensor.spotify_source").replace(" ", "_").lower() }}_main
spotify_down2:
  alias: "Spotify Volume Way Down"
  sequence:
    - service: media_player.volume_down
      data_template:
        entity_id: >
          media_player.{{ states("sensor.spotify_source").replace(" ", "_").lower() }}_main
    - service: media_player.volume_down
      data_template:
        entity_id: >
          media_player.{{ states("sensor.spotify_source").replace(" ", "_").lower() }}_main

spotify_living_room_check_if_on:
  alias: "Spotify Living Room - Check if Stereo On"
  sequence:
    - condition: template
      value_template: "{{ not is_state('media_player.living_room_stereo_main', 'off') }}"
    - service: media_player.select_source
      data:
        entity_id: media_player.spotify
        source: 'Living Room Stereo'

spotify_living_room:
  alias: "Spotify Living Room"
  sequence:
    - service: script.spotify_living_room_check_if_on
    - condition: state
      entity_id: media_player.living_room_stereo_main
      state: 'off'
    - service: media_player.turn_on
      entity_id: media_player.living_room_stereo_main
    - delay: '00:00:13'
    - service: media_player.select_source
      data:
        entity_id: media_player.spotify
        source: 'Living Room Stereo'

spotify_switch:
  alias: "Spotify Switch"
  sequence: 
    - service: media_player.turn_on
      data_template:
        entity_id: "media_player.{{ title.lower().replace(' ','_') }}_stereo_main"
    - service: media_player.select_source
      data_template:
        entity_id: media_player.spotify
        source: "{{ title }} Stereo"
    - delay: '00:00:02'
    - condition: template
      value_template: "is_state(media_player.{{ title.lower().replace(' ','_') }}_stereo_main, 'mc_link')"
    - service: script.spotify_living_room

spotify_switch_delay:
  alias: "Spotify Switch With Delay"
  sequence: 
    - service: media_player.turn_on
      data_template:
        entity_id: "media_player.{{ title.lower().replace(' ','_') }}_stereo_main"
    - delay: '00:00:02'
    - service: media_player.select_source
      data_template:
        entity_id: media_player.spotify
        source: "{{ title }} Stereo"
    - delay: '00:00:02'
    - condition: template
      value_template: "is_state(media_player.{{ title.lower().replace(' ','_') }}_stereo_main, 'mc_link')"
    - service: script.spotify_living_room

switch_to_tv:
  alias: "Switch to TV"
  sequence:
    - service: media_player.select_source
      data:
        entity_id: media_player.guest_room_stereo_main
        source: "tv"

spotify_bedroom:
  alias: "Spotify Bedroom"
  sequence:
    - service: script.spotify_switch
      data:
        title: "Bedroom"
spotify_kitchen:
  alias: "Spotify Kitchen"
  sequence:
    - service: script.spotify_switch
      data:
        title: "Kitchen"
spotify_basement:
  alias: "Spotify Basement"
  sequence:
    - service: script.spotify_switch
      data:
        title: "Basement"
spotify_guest_room:
  alias: "Spotify Guest Room"
  sequence:
    - service: script.spotify_switch
      data:
        title: "Guest Room"

# sonos_living_room_check_if_on:
#   alias: "Sonos Living Room - Check If Stereo On"
#   sequence:
#     - condition: template
#       value_template: "{{ not is_state('media_player.living_room_stereo_main', 'off') }}"
#     - service: media_player.select_source
#       data:
#         entity_id: media_player.living_room_stereo_main
#         source: 'audio2'

# sonos_living_room:
#   alias: "Sonos Living Room"
#   sequence:
#     - service: script.sonos_living_room_check_if_on
#     - condition: state
#       entity_id: media_player.living_room_stereo_main
#       state: 'off'
#     - service: media_player.media_pause
#       entity_id: media_player.living_room
#     - service: media_player.turn_on
#       entity_id: media_player.living_room_stereo_main
#     - delay: '00:00:13'
#     - service: media_player.select_source
#       data:
#         entity_id: media_player.living_room_stereo_main
#         source: 'audio2'
#     - service: media_player.media_play
#       entity_id: media_player.living_room

